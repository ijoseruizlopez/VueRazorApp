@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div id="app">

    <div class="block-ui d-flex" id="blockUi" v-if="isLoadingCoordinates">
        <div class="text-center">
            <div class="spinner-border text-light" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="text-white mt-3">Buscando la ubicación, espera...</p>
        </div>
    </div>

    <card-user v-for="user in users"
               :key="user.id"
               :user-name="user.name"
               :user-role="user.role"
               :user-country="user.country"
               :user-image="user.image">
    </card-user>

    <card-map></card-map>
</div>

<script>
    var _app = new Vue({
        el: '#app',
        store,
        data() {
            return {
                users: []
            };
        },
        computed: {

            isLoadingCoordinates() {
                return this.$store.getters.isLoadingCoordinates;
            }
        },
        created() {
            this.fetchUsers();
        },
        methods: {

            fetchUsers() {
                axios.get('/app/Users') 
                    .then(response => {
                        this.users = response.data;
                    })
                    .catch(error => {
                        console.error('Error fetching users:', error);
                    });
            }
        }
    });
</script>
